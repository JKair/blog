---
title: 服务器磁盘满了
date: 2015.10.28 00:50:36
tags: [centos]
categories: 后端
---

这两天回学校，突然发现协会的服务器遇上一个问题，就是挂载在根目录下的磁盘空间已经满了，一点空间都没有，导致mysql无法启动！nginx启动也失败！然而根本原因就是空间已经满到甚至不能生成日志了。下面记录下问题解决的过程：
1. 首先是使用`df -h` 查看各个磁盘的使用情况，还有挂载什么目录。
1. 发现磁盘快满了的是挂载在`/`目录下的。占用率99%。非常恐怖，触目惊心，然后是进行排查删除了
1. 用 `du -s -h *`可以查看各个目录的空间使用情况，发现了/var目录占用很高，于是想起，有可能是日志！遂把一些老旧的日志全部删除，一共删除了4G。
1. 重新`df -h` 发现磁盘占用依旧是99%！居高不下，但是已经没有任何东西可以删除了，其他东西都是系统的！不能动！很奇怪。百度了很久，看到[此篇文章](http://www.android100.org/html/201407/27/46936.html)，rm只是删除标志而已，你必须重启nginx问题才能得到解决。
1. `service nginx restart`,`service php-fpm restart`.`service mysqld restart`....